- T001: Add Type Hints for UML Class Diagram
  - Type: Enhancement
  - Priority: Medium
  - Status: Complete
  - Description: Add type hints using Python’s typing module (e.g., List, Optional) to instance variables and method parameters/return types to clarify relationships for PyCharm’s UML diagram. Ensure proper imports, preserve all comments, and follow PEP 8. The goal is to make associations (e.g., AppController → UIManager), dependencies, and compositions (e.g., Prayer → Category) visible in the UML diagram.
- T002: Grok File Retrieval Error
  - Type: Bug
  - Priority: High
  - Status: Deferred
  - Description: Grok retrieves incorrect db_manager.py (63 lines, starts with import sqlite3) from https://raw.githubusercontent.com/joscthomas/my_prayers/main/src/db_manager.py, despite the correct file having 376 lines. Recurred from August 2, 2025. Investigate potential caching, commit hash mismatch, or retrieval logic issues.
- T003: Test Data Directory
  - Type: Testing
  - Priority: Medium
  - Status: Complete
  - Description: Verify data_file_path from params.json works with a custom directory.
- T004: Test Fallback Loading
  - Type: Testing
  - Priority: Medium
  - Status: Complete
  - Description: Test loading from CSV/JSON when pickle file is missing.
- T005: Verify AppParams
  - Type: Code Update
  - Priority: High
  - Status: Complete
  - Description: Confirm AppParams in mpo_model.py correctly defines data_file_path.
- T006: Audit Pickle Data Integrity
  - Type: Code Review
  - Priority: High
  - Status: Complete
  - Description: Validate all `Prayer` attributes in `_load_from_pickle` in db_manager.py. Test with older pickle files to ensure compatibility.
- T007: Validate PrayerSession.last_panel_set
  - Type: Code Review
  - Priority: Medium
  - Status: Complete
  - Description: Add validation in `mpo_model.py` to ensure `PrayerSession.last_panel_set` matches panel sets in `panels.csv`.
- T008: Deprecate params.json
  - Type: Refactoring
  - Priority: Low
  - Status: Complete
  - Description: Review `params.json` usage; deprecate if all attributes (`last_panel_set`, `prayer_streak`, `last_prayer_date`) are moved to `PrayerSession`.
- WT006-001: Remove category_count from categories.json serialization in db_manager.py
  - Type: Refactor
  - Priority: High
  - Status: Complete
  - Description: Modify DBManager to exclude category_count when saving/loading categories.json.
- WT006-002: Add category_count to Category class in mpo_model.py
  - Type: Enhancement
  - Priority: High
  - Status: Complete
  - Description: Ensure Category class has category_count attribute initialized to 0.
- WT006-003: Increment category_count in ui_manager.py
  - Type: Enhancement
  - Priority: High
  - Status: Complete
  - Description: Update display_prayer to increment Category.category_count for the prayer's category.
- WT006-004: Verify app_controller.py data flow
  - Type: Verification
  - Priority: Medium
  - Status: Complete
  - Description: Ensure display_prayer call passes category data correctly.
- WT006-005: Test category count updates
  - Type: Testing
  - Priority: Medium
  - Status: Complete
  - Description: Add unit tests to verify category_count increments correctly.
- WT007-001: Persist Prayer.display_count in db_manager.py
  - Type: Bug Fix
  - Priority: High
  - Status: Complete
  - Description: Ensure Prayer.display_count is persisted correctly in db_manager.py when saving to pickle.
- T019: Add unit tests for core components
  - Type: Testing
  - Priority: Medium
  - Status: Complete
  - Description: Add pytest tests for PrayerSelector, SessionManager, and AppController to cover prayer selection, session management, and state handling.
- T020: Fix pytest module import errors
  - Type: Bug
  - Priority: High
  - Status: Complete
  - Description: Resolve ModuleNotFoundError for 'mpo_model' in test_db_manager.py, test_ui_manager.py, and test_app_controller.py by correcting pytest.ini to use 'pythonpath = src' and ensuring src/__init__.py and tests/__init__.py are present.
- T021: Fix params.json path in db_manager.py
  - Type: Bug Fix
  - Priority: High
  - Status: Open
  - Description: Update PersistenceManager.load_json in db_manager.py to use absolute path or default params to avoid 'JSON file ../data/params.json not found' in AppController tests.
- T022: Fix PersistenceManager.save_json file path
  - Type: Bug Fix
  - Priority: Medium
  - Status: Open
  - Description: Update PersistenceManager.save_json in db_manager.py to prepend data_dir to file_path to match test expectations in test_persistence_manager_save_json.
- T023: Fix PersistenceManager.load_pickle logic
  - Type: Bug Fix
  - Priority: Medium
  - Status: Open
  - Description: Investigate and fix PersistenceManager.load_pickle to return correct data structure instead of empty dict in test_persistence_manager_load_pickle_valid.
- T024: Investigate AppDisplay isinstance checks
  - Type: Bug Fix
  - Priority: Medium
  - Status: Open
  - Description: Investigate why isinstance checks in AppDisplay.display_panel, get_answer, and display_prayer fail in ui_manager.py, possibly due to import or class mismatches.
- WT014-001: Fix AppDisplay isinstance checks in ui_manager.py
  - Type: Bug Fix
  - Priority: Medium
  - Status: Open
  - Description: Resolve isinstance check failures in AppDisplay.display_panel, get_answer, and display_prayer in ui_manager.py to fix test failures in test_ui_manager.py.
- WT015-001: Fix AppDatabase.close in db_manager.py
  - Type: Bug Fix
  - Priority: Medium
  - Status: Open
  - Description: Update AppDatabase.close to ensure PersistenceManager.save_pickle is called to fix test failures in test_app_database_close.
- WT016-001: Remove answered_prayers list from PrayerManager
  - Type: Refactor
  - Priority: High
  - Status: Complete
  - Description: Remove the answered_prayers list from PrayerManager in db_manager.py, update load_prayers and create_prayer to not populate it, and modify get_unanswered_prayers to filter prayers where answer_date is None.
- WT016-002: Update get_past_prayers in app_controller.py
  - Type: Refactor
  - Priority: High
  - Status: Complete
  - Description: Remove logic in get_past_prayers that removes prayers from answered_prayers when marked as answered, as answered_prayers list is deprecated.
- WT016-003: Test removal of answered_prayers list
  - Type: Testing
  - Priority: Medium
  - Status: Open
  - Description: Add unit tests to verify that removing answered_prayers from PrayerManager does not affect functionality and that get_unanswered_prayers correctly filters prayers with answer_date is None.
- TD001: Handle missing params.json
  - Type: Enhancement
  - Priority: Medium
  - Status: Open
  - Description: In AppDatabase._load_params, add logic to create a default params.json with minimal required fields if the file is missing.
- WT017-001: Update State class attribute from name to state
  - Type: Refactor
  - Priority: Medium
  - Status: Complete
  - Description: Change State class attribute from 'name' to 'state' in mpo_model.py, update StateMachine to use 'state', and adjust validation to use sequence-based required states.
- WT017-002: Enhance PanelManager for panel sequence validation
  - Type: Enhancement
  - Priority: Medium
  - Status: Complete
  - Description: Update db_manager.py to validate panel count against non-auto_trigger states for all panel sets on load, sort panels by panel_set, panel_seq, pgraph_seq, and add get_next_panel method.
- WT017-003: Update AppController for panel sequence logic
  - Type: Refactor
  - Priority: Medium
  - Status: Complete
  - Description: Modify app_controller.py to initialize last_displayed_panel_seq to 0, replace get_panel_by_header with get_next_panel, and raise error if no panel found for state.
- WT017-004: Test panel sequence and state transitions
  - Type: Testing
  - Priority: Medium
  - Status: Open
  - Description: Add pytest tests to verify panel sequence selection (minimal panel_seq > last_displayed), state transitions, and error handling for missing panels in AppController and PanelManager.
- WT018-001: Fix NaN display in panels
  - Type: Bug Fix
  - Priority: High
  - Status: Complete
  - Description: Update PanelManager.load_panels in db_manager.py to convert NaN values to None for verse and text fields when creating PanelPgraph objects to prevent "nan" from being displayed in the UI.
- WT018-002: Test NaN handling in PanelManager
  - Type: Testing
  - Priority: Medium
  - Status: Open
  - Description: Add pytest tests to verify that NaN values in panels.csv are correctly converted to None in PanelManager.load_panels and do not appear in the UI output.
- TD009 Move get_next_panel to PanelManager
  - Type: Refactor
  - Priority: Medium
  - Status: Open
  - Description: Move get_next_panel logic from AppController to PanelManager in db_manager.py for better encapsulation.
- TD011 Validate category-prayer alignment
  - Type: Enhancement
  - Priority: Medium
  - Status: Open
  - Description: Add validation in CategoryManager.load_categories to ensure categories in categories.json align with prayers in prayers.csv.
- TD012 Audit pickle file contents
  - Type: Enhancement
  - Priority: Low
  - Status: Open
  - Description: Add logging in AppDatabase.close to confirm Category_instances are saved to objects.pkl.
- TD013 Add unit test for AppDatabase._validate_session
  - Type: Enhancement
  - Priority: Medium
  - Status: Open
  - Description: Add unit test in tests/ directory for AppDatabase._validate_session to verify session validation logic.
- TD014 Review type annotations
  - Type: Enhancement
  - Priority: Low
  - Status: Open
  - Description: Audit type annotations in db_manager.py for consistent use of Optional where None is possible.
- WT019-001: Fix categories pickle loading bug
  - Type: Bug Fix
  - Priority: Critical
  - Status: Complete
  - Description: Ensure Category_instances from pickle are preserved by skipping CategoryManager.load_categories if categories are loaded from pickle in AppDatabase.__init__.